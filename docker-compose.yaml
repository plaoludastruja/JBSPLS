version: "3.3"
services:
  user_service:
    image: user_service
    container_name: user_service
    build:
      context: .
      dockerfile: ./Skitnica/backend/user_service/Dockerfile
    restart: on-failure
    environment:
      USER_DB_HOST: ${USER_DB_HOST}
      USER_DB_PORT: ${USER_DB_PORT}
      USER_SERVICE_PORT: ${USER_SERVICE_PORT}
    depends_on:
      - user_db
    networks:
      - network

  api_gateway:
    image: api_gateway
    container_name: api_gateway
    build:
      context: .
      dockerfile: ./Skitnica/backend/api_gateway/Dockerfile
    restart: on-failure
    ports:
      - ${GATEWAY_PORT}:${GATEWAY_PORT}
    environment:
      GATEWAY_PORT: ${GATEWAY_PORT}
      USER_SERVICE_HOST: ${USER_SERVICE_HOST}
      USER_SERVICE_PORT: ${USER_SERVICE_PORT}
    networks:
      - network

  user_db:
    image: mongo
    container_name: user_db
    restart: on-failure
    networks:
      - network
    ports:
      - ${USER_DB_PORT}:${USER_DB_PORT}

networks:
  network:
    driver: bridge

  # #baza
  # mongo:
  #   image: "mongo:latest"
  #   container_name: "mongo"
  #   ports:
  #     - "27017:27017"
  #   volumes:
  #     - type: bind
  #       source: ./data
  #       target: /data/db
  # #back
  # lsbackend:
  #   container_name: "lsbackend"
  #   build: "./LetiSleti/LSbackend"
  #   ports:
  #     - "8080:8080"
  #   volumes:
  #     - "./LetiSleti/LSbackend:/app"
  #   depends_on:
  #     - "mongo"
  # #front
  # lsfrontend:
  #   container_name: "lsfrontend"
  #   build: "./LetiSleti/LSfrontend"
  #   ports:
  #     - "4200:4200"
  #   volumes:
  #     - "./LetiSleti/LSfrontend:/usr/local/app"
  #   depends_on:
  #     - "lsbackend"
